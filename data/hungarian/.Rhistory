average_match_rate <- data %>%
summarize(average_rate = mean(match_status)) %>%
pull(average_rate)
print(average_match_rate)
# Calculate the match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
# Define age groups
subject_match_rates$age_group <- cut(subject_match_rates$subject_age,
breaks = c(0, 20, 40, 60),
labels = c("0-20", "21-40", "41-60", "61+"))
subject_match_rates
# Load required packages
library(tidyverse)
# Define the function to label vowels
label_vowel <- function(stem) {
# Define the vowels for each category
back_vowels <- c("a", "á", "o", "ó", "u", "ú")
front_rounded_vowels <- c("ö", "ő", "ü", "ű")
front_unrounded_vowels <- c("e", "é", "i", "í")
# Identify vowels in the stem and label them accordingly
back_label <- ifelse(any(str_detect(stem, back_vowels)), "B", "")
front_rounded_label <- ifelse(any(str_detect(stem, front_rounded_vowels)), "F", "")
# Count the number of front unrounded vowels and create the label
front_unrounded_count <- sum(str_count(stem, paste(front_unrounded_vowels, collapse = "|")))
front_unrounded_label <- strrep("N", front_unrounded_count)
label <- paste0(back_label, front_rounded_label, front_unrounded_label)
return(label)
}
# Reading data, creating vowel labels, and adding the match_status column
data <- read.table("wug_test_result.txt", header = TRUE, sep = "\t") %>%
mutate(
vowel_label = map_chr(stem, label_vowel),
match_status = ifelse(predicted_nAk == option_chosen, 1, 0)
)
data
subject_match_rates
view(data)
# Define age groups
data$age_group <- cut(data$subject_age,
breaks = c(0, 20, 40, 60),
labels = c("0-20", "21-40", "41-60", "61+"))
# Define age groups
data$age_group <- cut(data$subject_age,
breaks = c(0, 20, 40, 60, inf),
labels = c("0-20", "21-40", "41-60", "61+"))
# Define age groups
data$age_group <- cut(data$subject_age,
breaks = c(0, 20, 40, 60, inf),
labels = c("0-20", "21-40", "41-60", "61+"))
# Define age groups
data$age_group <- cut(data$subject_age,
breaks = c(0, 20, 40, 60, -inf),
labels = c("0-20", "21-40", "41-60", "61+"))
# Define age groups
data$age_group <- cut(data$subject_age,
breaks = c(0, 20, 40, 60, Inf),
labels = c("0-20", "21-40", "41-60", "61+"))
setwd("/Users/hutengdai/Documents/projects/alternation-learning/data/hungarian/")
# Load required packages
library(tidyverse)
# Define the function to label vowels
label_vowel <- function(stem) {
# Define the vowels for each category
back_vowels <- c("a", "á", "o", "ó", "u", "ú")
front_rounded_vowels <- c("ö", "ő", "ü", "ű")
front_unrounded_vowels <- c("e", "é", "i", "í")
# Identify vowels in the stem and label them accordingly
back_label <- ifelse(any(str_detect(stem, back_vowels)), "B", "")
front_rounded_label <- ifelse(any(str_detect(stem, front_rounded_vowels)), "F", "")
# Count the number of front unrounded vowels and create the label
front_unrounded_count <- sum(str_count(stem, paste(front_unrounded_vowels, collapse = "|")))
front_unrounded_label <- strrep("N", front_unrounded_count)
label <- paste0(back_label, front_rounded_label, front_unrounded_label)
return(label)
}
# Reading data, creating vowel labels, and adding the match_status column
data <- read.table("wug_test_result.txt", header = TRUE, sep = "\t") %>%
mutate(
vowel_label = map_chr(stem, label_vowel),
match_status = ifelse(predicted_nAk == option_chosen, 1, 0)
)
# Calculate the match rate for each vowel label
vowel_label_match_rates <- data %>%
mutate(vowel_label = map_chr(stem, label_vowel)) %>%
group_by(vowel_label) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
# Assuming your data has columns named 'subject_code' and 'subject_age'
# Group by subject and calculate match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code, subject_age) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
# Define age groups
subject_match_rates$age_group <- cut(subject_match_rates$subject_age,
breaks = c(0, 20, 40, 60, Inf),
labels = c("0-20", "21-40", "41-60", "61+"))
# Create a violin plot of match rates, faceted by age group
p_violin_faceted <- ggplot(subject_match_rates, aes(x = match_rate, y = ..count..)) +
geom_violin(trim = FALSE) +
geom_boxplot(width=0.1, fill="white") + # Adds a boxplot inside the violin for better visualization
labs(
title = "Distribution of Match Rates Across Subjects by Age Group",
x = "Match Rate",
y = "Number of Subjects"
) +
facet_wrap(~ age_group) +
theme_bw() +
theme(
text = element_text(family = "Times New Roman", size = 12),
axis.line = element_line(size = 0.1),
axis.ticks.length = unit(0.15, "inches"),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16)
)
# Display the plot
print(p_violin_faceted)
subject_match_rates
# Define age groups
subject_match_rates$age_group <- cut(subject_match_rates$subject_age,
breaks = c(0, 20, 40, 60, Inf),
labels = c("0-20", "21-40", "41-60", "61+"))
# Create a violin plot of match rates, faceted by age group
p_violin_faceted <- ggplot(subject_match_rates, aes(x = match_rate, y = ..count..)) +
geom_violin(trim = FALSE) +
geom_boxplot(width=0.1, fill="white") + # Adds a boxplot inside the violin for better visualization
labs(
title = "Distribution of Match Rates Across Subjects by Age Group",
x = "Match Rate",
y = "Number of Subjects"
) +
facet_wrap(~ age_group) +
theme_bw() +
theme(
text = element_text(family = "Times New Roman", size = 12),
axis.line = element_line(size = 0.1),
axis.ticks.length = unit(0.15, "inches"),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16)
)
# Display the plot
print(p_violin_faceted)
setwd("/Users/hutengdai/Documents/projects/alternation-learning/data/hungarian/")
# Load required packages
library(tidyverse)
# Define the function to label vowels
label_vowel <- function(stem) {
# Define the vowels for each category
back_vowels <- c("a", "á", "o", "ó", "u", "ú")
front_rounded_vowels <- c("ö", "ő", "ü", "ű")
front_unrounded_vowels <- c("e", "é", "i", "í")
# Identify vowels in the stem and label them accordingly
back_label <- ifelse(any(str_detect(stem, back_vowels)), "B", "")
front_rounded_label <- ifelse(any(str_detect(stem, front_rounded_vowels)), "F", "")
# Count the number of front unrounded vowels and create the label
front_unrounded_count <- sum(str_count(stem, paste(front_unrounded_vowels, collapse = "|")))
front_unrounded_label <- strrep("N", front_unrounded_count)
label <- paste0(back_label, front_rounded_label, front_unrounded_label)
return(label)
}
# Reading data, creating vowel labels, and adding the match_status column
data <- read.table("wug_test_result.txt", header = TRUE, sep = "\t") %>%
mutate(
vowel_label = map_chr(stem, label_vowel),
match_status = ifelse(predicted_nAk == option_chosen, 1, 0)
)
# Calculate the match rate for each vowel label
vowel_label_match_rates <- data %>%
mutate(vowel_label = map_chr(stem, label_vowel)) %>%
group_by(vowel_label) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
# Create a violin plot of match rates, faceted by age group
p_violin_faceted <- ggplot(subject_match_rates, aes(x = match_rate, y = age_group)) +
geom_violin(aes(y = age_group), trim = FALSE) +
geom_dotplot(binaxis='y', stackdir='center', dotsize = 0.5, aes(fill = age_group)) +
labs(
title = "Distribution of Match Rates Across Subjects by Age Group",
x = "Match Rate",
y = "Age Group"
) +
facet_wrap(~ age_group) +
theme_bw() +
theme(
text = element_text(family = "Times New Roman", size = 12),
axis.line = element_line(size = 0.1),
axis.ticks.length = unit(0.15, "inches"),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16),
legend.position = "none"
)
# Display the plot
print(p_violin_faceted)
# Create a histogram of match rates
p_histogram <- ggplot(subject_match_rates, aes(x = match_rate)) +
geom_histogram(binwidth = 0.05, fill = "skyblue", color = "black", alpha = 0.7) + # binwidth controls the width of each bar
labs(
title = "Distribution of Match Rates Across Subjects",
x = "Match Rate",
y = "Number of Subjects"
) +
theme_bw() +
theme(
text = element_text(family = "Times New Roman", size = 12),
axis.line = element_line(size = 0.1),
axis.ticks.length = unit(0.15, "inches"),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16)
)
# Display the plot
print(p_histogram)
setwd("/Users/hutengdai/Documents/projects/alternation-learning/data/hungarian/")
# Load required packages
library(tidyverse)
# Define the function to label vowels
label_vowel <- function(stem) {
# Define the vowels for each category
back_vowels <- c("a", "á", "o", "ó", "u", "ú")
front_rounded_vowels <- c("ö", "ő", "ü", "ű")
front_unrounded_vowels <- c("e", "é", "i", "í")
# Identify vowels in the stem and label them accordingly
back_label <- ifelse(any(str_detect(stem, back_vowels)), "B", "")
front_rounded_label <- ifelse(any(str_detect(stem, front_rounded_vowels)), "F", "")
# Count the number of front unrounded vowels and create the label
front_unrounded_count <- sum(str_count(stem, paste(front_unrounded_vowels, collapse = "|")))
front_unrounded_label <- strrep("N", front_unrounded_count)
label <- paste0(back_label, front_rounded_label, front_unrounded_label)
return(label)
}
# Reading data, creating vowel labels, and adding the match_status column
data <- read.table("wug_test_result.txt", header = TRUE, sep = "\t") %>%
mutate(
vowel_label = map_chr(stem, label_vowel),
match_status = ifelse(predicted_nAk == option_chosen, 1, 0)
)
# Calculate the match rate for each vowel label
vowel_label_match_rates <- data %>%
mutate(vowel_label = map_chr(stem, label_vowel)) %>%
group_by(vowel_label) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
# Assuming your data has columns named 'subject_code' and 'subject_age'
# Group by subject and calculate match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code, subject_age) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
# First, create a factor column for age groups. For simplicity, let's assume three age groups: "20-39", "40-59", "60+".
# Adjust these bins according to your dataset.
data <- data %>%
mutate(
age_group = cut(subject_age,
breaks = c(0, 20, 40, 60, Inf),
labels = c("<20", "20-39", "40-59", "60+"),
right = FALSE)
)
# Then, compute the match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code, age_group) %>%
summarize(match_rate = mean(match_status, na.rm = TRUE)) %>%
ungroup()
# Create a histogram of match rates, faceted by age group
p_histogram <- ggplot(subject_match_rates, aes(x = match_rate)) +
geom_histogram(binwidth = 0.05, fill = "skyblue", color = "black", alpha = 0.7) +
labs(
title = "Distribution of Match Rates Across Subjects by Age Group",
x = "Match Rate",
y = "Number of Subjects"
) +
facet_wrap(~ age_group) +
theme_bw() +
theme(
text = element_text(family = "Times New Roman", size = 12),
axis.line = element_line(size = 0.1),
axis.ticks.length = unit(0.15, "inches"),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16)
)
# Display the plot
print(p_histogram)
setwd("/Users/hutengdai/Documents/projects/alternation-learning/data/hungarian/")
# Load required packages
library(tidyverse)
# Define the function to label vowels
label_vowel <- function(stem) {
# Define the vowels for each category
back_vowels <- c("a", "á", "o", "ó", "u", "ú")
front_rounded_vowels <- c("ö", "ő", "ü", "ű")
front_unrounded_vowels <- c("e", "é", "i", "í")
# Identify vowels in the stem and label them accordingly
back_label <- ifelse(any(str_detect(stem, back_vowels)), "B", "")
front_rounded_label <- ifelse(any(str_detect(stem, front_rounded_vowels)), "F", "")
# Count the number of front unrounded vowels and create the label
front_unrounded_count <- sum(str_count(stem, paste(front_unrounded_vowels, collapse = "|")))
front_unrounded_label <- strrep("N", front_unrounded_count)
label <- paste0(back_label, front_rounded_label, front_unrounded_label)
return(label)
}
# Reading data, creating vowel labels, and adding the match_status column
data <- read.table("wug_test_result.txt", header = TRUE, sep = "\t") %>%
mutate(
vowel_label = map_chr(stem, label_vowel),
match_status = ifelse(predicted_nAk == option_chosen, 1, 0)
)
# Calculate the match rate for each vowel label
vowel_label_match_rates <- data %>%
mutate(vowel_label = map_chr(stem, label_vowel)) %>%
group_by(vowel_label) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
# Assuming your data has columns named 'subject_code' and 'subject_age'
# Group by subject and calculate match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code, subject_age) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
# First, create a factor column for age groups. For simplicity, let's assume three age groups: "20-39", "40-59", "60+".
# Adjust these bins according to your dataset.
data <- data %>%
mutate(
age_group = cut(subject_age,
breaks = c(0, 20, 40, 60, Inf),
labels = c("<20", "20-39", "40-59", "60+"),
right = FALSE)
)
# Then, compute the match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code, age_group) %>%
summarize(match_rate = mean(match_status, na.rm = TRUE)) %>%
ungroup()
# Create a histogram of match rates, faceted by age group
p_histogram <- ggplot(subject_match_rates, aes(x = match_rate)) +
geom_histogram(binwidth = 0.05, fill = "skyblue", color = "black", alpha = 0.7) +
labs(
title = "Distribution of Match Rates Across Subjects by Age Group",
x = "Match Rate",
y = "Number of Subjects"
) +
facet_wrap(~ age_group) +
theme_bw() +
theme(
text = element_text(family = "Times New Roman", size = 12),
axis.line = element_line(size = 0.1),
axis.ticks.length = unit(0.15, "inches"),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16)
)
# Display the plot
print(p_histogram)
# First, create a factor column for age groups. For simplicity, let's assume three age groups: "20-39", "40-59", "60+".
# Adjust these bins according to your dataset.
data <- data %>%
mutate(
age_group = cut(subject_age,
breaks = c(0, 30, 60, Inf),
labels = c("<30", "30-59", "60+"),
right = FALSE)
)
# Then, compute the match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code, age_group) %>%
summarize(match_rate = mean(match_status, na.rm = TRUE)) %>%
ungroup()
# Create a histogram of match rates, faceted by age group
p_histogram <- ggplot(subject_match_rates, aes(x = match_rate)) +
geom_histogram(binwidth = 0.05, fill = "skyblue", color = "black", alpha = 0.7) +
labs(
title = "Distribution of Match Rates Across Subjects by Age Group",
x = "Match Rate",
y = "Number of Subjects"
) +
facet_wrap(~ age_group) +
theme_bw() +
theme(
text = element_text(family = "Times New Roman", size = 12),
axis.line = element_line(size = 0.1),
axis.ticks.length = unit(0.15, "inches"),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16)
)
# Display the plot
print(p_histogram)
# First, create a factor column for age groups. For simplicity, let's assume three age groups: "20-39", "40-59", "60+".
# Adjust these bins according to your dataset.
data <- data %>%
mutate(
age_group = cut(subject_age,
breaks = c(0, 20, 40, 60, Inf),
labels = c("<20", "20-39", "40-59", "60+"),
right = FALSE)
)
# Then, compute the match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code, age_group) %>%
summarize(match_rate = mean(match_status, na.rm = TRUE)) %>%
ungroup()
# Create a histogram of match rates, faceted by age group
p_histogram <- ggplot(subject_match_rates, aes(x = match_rate)) +
geom_histogram(binwidth = 0.05, fill = "skyblue", color = "black", alpha = 0.7) +
labs(
title = "Distribution of Match Rates Across Subjects by Age Group",
x = "Match Rate",
y = "Number of Subjects"
) +
facet_wrap(~ age_group) +
theme_bw() +
theme(
text = element_text(family = "Times New Roman", size = 12),
axis.line = element_line(size = 0.1),
axis.ticks.length = unit(0.15, "inches"),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16)
)
# Display the plot
print(p_histogram)
subject_match_rates
# Calculate the match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
# Create a horizontal violin plot of match rates
p_violin <- ggplot(subject_match_rates, aes(y = 1, x = match_rate)) +
geom_violin(trim = FALSE) +
geom_boxplot(width=0.2, fill="white", orientation="y") + # Flips the boxplot
labs(
title = "Distribution of Match Rates Across Subjects",
x = "Match Rate"
) +
theme_bw() +
theme(
text = element_text(family = "Times New Roman", size = 12),
axis.line = element_line(size = 0.1),
axis.ticks.length = unit(0.15, "inches"),
axis.title = element_text(size = 16),
axis.text = element_text(size = 16),
axis.title.y=element_blank(),    # Hide the y-axis title
axis.text.y=element_blank(),     # Hide the y-axis text
axis.ticks.y=element_blank()     # Hide the y-axis ticks
)
# Display the plot
print(p_violin)
subject_match_rates
# Calculate the percentage of correct responses for each subject
subject_summary <- subject_summary %>%
mutate(percentage_correct = (correct_responses / total_responses) * 100)
subject_summary
# Count the number of subjects in each performance category
performance_distribution <- subject_summary %>%
group_by(performance_category) %>%
summarize(count = n()) %>%
ungroup()
performance_distribution
setwd("/Users/hutengdai/Documents/projects/alternation-learning/data/hungarian/")
# Load required packages
library(tidyverse)
# Define the function to label vowels
label_vowel <- function(stem) {
# Define the vowels for each category
back_vowels <- c("a", "á", "o", "ó", "u", "ú")
front_rounded_vowels <- c("ö", "ő", "ü", "ű")
front_unrounded_vowels <- c("e", "é", "i", "í")
# Identify vowels in the stem and label them accordingly
back_label <- ifelse(any(str_detect(stem, back_vowels)), "B", "")
front_rounded_label <- ifelse(any(str_detect(stem, front_rounded_vowels)), "F", "")
# Count the number of front unrounded vowels and create the label
front_unrounded_count <- sum(str_count(stem, paste(front_unrounded_vowels, collapse = "|")))
front_unrounded_label <- strrep("N", front_unrounded_count)
label <- paste0(back_label, front_rounded_label, front_unrounded_label)
return(label)
}
# Assuming your data has columns named 'subject_code' and 'subject_age'
# Group by subject and calculate match rate for each subject
subject_match_rates <- data %>%
group_by(subject_code, subject_age) %>%
summarize(match_rate = mean(match_status)) %>%
ungroup()
subject_match_rates
# Group data by subject and summarize
subject_summary <- data %>%
group_by(subject_code) %>%
summarize(
subject_age = subject_age,
subject_sex = subject_sex,
total_responses = n(),
correct_responses = sum(match_status),
incorrect_responses = total_responses - correct_responses
) %>%
ungroup() %>%
mutate(performance_category = case_when(
correct_responses == total_responses ~ "All Correct",
incorrect_responses == total_responses ~ "All Incorrect",
TRUE ~ "Mixed"
))
# Calculate the percentage of correct responses for each subject
subject_summary <- subject_summary %>%
mutate(percentage_correct = (correct_responses / total_responses) * 100)
subject_summary
# Count the number of subjects in each performance category
performance_distribution <- subject_summary %>%
group_by(performance_category) %>%
summarize(count = n()) %>%
ungroup()
# Display the result
print(performance_distribution)
setwd("/Users/hutengdai/Documents/projects/alternation-learning/data/hungarian/")
setwd("/Users/hutengdai/Documents/projects/alternation-learning/data/hungarian/")
# Load required packages
library(tidyverse)
