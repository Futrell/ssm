  0%|          | 0/1616 [00:00<?, ?it/s]  0%|          | 1/1616 [00:05<2:37:31,  5.85s/it]  0%|          | 2/1616 [00:11<2:28:50,  5.53s/it]  0%|          | 3/1616 [00:16<2:27:14,  5.48s/it]  0%|          | 4/1616 [00:21<2:25:59,  5.43s/it]  0%|          | 5/1616 [00:27<2:24:56,  5.40s/it]  0%|          | 6/1616 [00:32<2:24:52,  5.40s/it]  0%|          | 7/1616 [00:38<2:24:12,  5.38s/it]  0%|          | 8/1616 [00:43<2:24:26,  5.39s/it]  1%|          | 9/1616 [00:48<2:23:56,  5.37s/it]  1%|          | 10/1616 [00:54<2:24:16,  5.39s/it]  1%|          | 11/1616 [00:59<2:23:44,  5.37s/it]  1%|          | 12/1616 [01:04<2:23:27,  5.37s/it]  1%|          | 13/1616 [01:10<2:23:53,  5.39s/it]  1%|          | 14/1616 [01:15<2:23:18,  5.37s/it]  1%|          | 15/1616 [01:21<2:23:34,  5.38s/it]  1%|          | 16/1616 [01:26<2:22:51,  5.36s/it]  1%|          | 17/1616 [01:31<2:23:06,  5.37s/it]  1%|          | 18/1616 [01:37<2:22:54,  5.37s/it]  1%|          | 19/1616 [01:42<2:22:49,  5.37s/it]  1%|          | 20/1616 [01:47<2:23:16,  5.39s/it]  1%|▏         | 21/1616 [01:53<2:23:26,  5.40s/it]  1%|▏         | 22/1616 [01:58<2:23:33,  5.40s/it]  1%|▏         | 23/1616 [02:04<2:23:12,  5.39s/it]  1%|▏         | 24/1616 [02:09<2:23:05,  5.39s/it]  2%|▏         | 25/1616 [02:14<2:23:09,  5.40s/it]  2%|▏         | 26/1616 [02:20<2:22:24,  5.37s/it]  2%|▏         | 27/1616 [02:25<2:22:19,  5.37s/it]  2%|▏         | 28/1616 [02:30<2:21:53,  5.36s/it]  2%|▏         | 29/1616 [02:36<2:22:35,  5.39s/it]  2%|▏         | 30/1616 [02:41<2:23:07,  5.41s/it]  2%|▏         | 31/1616 [02:47<2:24:23,  5.47s/it]  2%|▏         | 32/1616 [02:52<2:24:45,  5.48s/it]  2%|▏         | 33/1616 [02:58<2:24:57,  5.49s/it]  2%|▏         | 33/1616 [02:59<2:23:42,  5.45s/it]
step,epoch,mean_loss,good_scores,bad_scores,diff,batch_size,lr
0,0,40.477463,-66.76632690429688,-66.78533172607422,0.01900482177734375,32,0.001
1,0,41.427193,-66.75678253173828,-66.78296661376953,0.02618408203125,32,0.001
2,0,40.9217,-66.74748992919922,-66.7803726196289,0.0328826904296875,32,0.001
3,0,42.12027,-66.7381362915039,-66.77788543701172,0.0397491455078125,32,0.001
4,0,41.91192,-66.72879791259766,-66.77549743652344,0.04669952392578125,32,0.001
5,0,39.69687,-66.7195053100586,-66.77320098876953,0.0536956787109375,32,0.001
6,0,42.247772,-66.71028900146484,-66.77098083496094,0.06069183349609375,32,0.001
7,0,41.146317,-66.70112609863281,-66.76875305175781,0.067626953125,32,0.001
8,0,41.59269,-66.69200134277344,-66.76654815673828,0.07454681396484375,32,0.001
9,0,39.723263,-66.68289184570312,-66.7643814086914,0.08148956298828125,32,0.001
10,0,42.07687,-66.67378234863281,-66.76226043701172,0.08847808837890625,32,0.001
11,0,39.375435,-66.66484069824219,-66.75999450683594,0.09515380859375,32,0.001
12,0,41.67524,-66.65596771240234,-66.75775146484375,0.10178375244140625,32,0.001
13,0,39.50898,-66.64714050292969,-66.75550079345703,0.10836029052734375,32,0.001
14,0,41.748104,-66.63825988769531,-66.75334167480469,0.115081787109375,32,0.001
15,0,39.751965,-66.62944030761719,-66.75116729736328,0.12172698974609375,32,0.001
16,1,40.3395,-66.62062072753906,-66.74906921386719,0.128448486328125,32,0.001
17,1,40.6046,-66.6119384765625,-66.74685668945312,0.134918212890625,32,0.001
18,1,41.028526,-66.60321044921875,-66.7447280883789,0.14151763916015625,32,0.001
19,1,40.455986,-66.59468078613281,-66.74242401123047,0.14774322509765625,32,0.001
20,1,41.077477,-66.5861587524414,-66.74015045166016,0.15399169921875,32,0.001
21,1,41.015114,-66.57755279541016,-66.7379379272461,0.1603851318359375,32,0.001
22,1,40.10005,-66.56893157958984,-66.73582458496094,0.16689300537109375,32,0.001
23,1,40.50697,-66.56034088134766,-66.7337646484375,0.17342376708984375,32,0.001
24,1,41.20002,-66.5517349243164,-66.73173522949219,0.18000030517578125,32,0.001
25,1,40.675022,-66.54307556152344,-66.72982788085938,0.1867523193359375,32,0.001
26,1,41.091835,-66.53441619873047,-66.72793579101562,0.19351959228515625,32,0.001
27,1,42.965057,-66.52568054199219,-66.72612762451172,0.20044708251953125,32,0.001
28,1,41.592636,-66.51700592041016,-66.72428894042969,0.20728302001953125,32,0.001
29,1,40.744293,-66.50845336914062,-66.72240447998047,0.21395111083984375,32,0.001
30,1,39.99688,-66.50001525878906,-66.72042083740234,0.22040557861328125,32,0.001
31,1,41.2705,-66.49160766601562,-66.71845245361328,0.22684478759765625,32,0.001
32,2,40.69574,-66.4831771850586,-66.716552734375,0.23337554931640625,32,0.001
Traceback (most recent call last):
  File "/Users/huteng/Desktop/ssm/eval_model.py", line 120, in <module>
    model.train(
    ~~~~~~~~~~~^
        batches,
        ^^^^^^^^
    ...<7 lines>...
        }
        ^
    )
    ^
  File "/Users/huteng/Desktop/ssm/ssm.py", line 252, in train
    diagnostic |= {label : fn(self) for label, fn in diagnostic_fns.items()}
                           ~~^^^^^^
  File "/Users/huteng/Desktop/ssm/eval_model.py", line 60, in compute_good_scores
    return model.log_likelihood(test_data[True]).mean().item()
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/huteng/Desktop/ssm/ssm.py", line 316, in log_likelihood
    y = torch.stack([wfsa(x, debug=debug) for x in xs])
                     ~~~~^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/huteng/Desktop/ssm/ssm.py", line 108, in forward
    x = self.semiring.mv(A, x)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/torch/fx/traceback.py", line 189, in format_stack
    return traceback.format_list(traceback.extract_stack()[:-1])
                                 ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/traceback.py", line 260, in extract_stack
    stack = StackSummary.extract(walk_stack(f), limit=limit)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/traceback.py", line 449, in extract
    return klass._extract_from_extended_frame_gen(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        extended_frame_gen(), limit=limit, lookup_lines=lookup_lines,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        capture_locals=capture_locals)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/traceback.py", line 500, in _extract_from_extended_frame_gen
    f.line
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/traceback.py", line 373, in line
    self._set_lines()
    ~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/traceback.py", line 351, in _set_lines
    line = linecache.getline(self.filename, lineno).rstrip()
KeyboardInterrupt
